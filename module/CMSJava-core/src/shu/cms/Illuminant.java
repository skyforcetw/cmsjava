package shu.cms;

import java.io.*;
import java.util.*;

import shu.cms.colorformat.cxf.*;
import shu.cms.colorspace.independ.*;
import shu.cms.reference.cie.*;
import shu.math.*;
import shu.math.array.*;
import shu.cms.plot.*;

/**
 * <p>Title: Colour Management System</p>
 *
 * <p>Description: </p>
 *
 * <p>Copyright: Copyright (c) 2006</p>
 *
 * <p>Company: </p>
 *
 * @author cms.shu.edu.tw
 * @version 1.0
 */
public final class Illuminant
    implements SpectraIF, Serializable {

  /**
   *
   * @return Illuminant[]
   */
  public final static Illuminant[] getDailyIlluminants() {
    List<Illuminant> list = new ArrayList<Illuminant> ();
    //31
    for (int cct = 2500; cct <= 10000; cct += 250) {
      //黑體輻射
      Spectra s = CorrelatedColorTemperature.getSpectraOfBlackbodyRadiator(cct);
      Illuminant i = new Illuminant(s);
      list.add(i);
    }
    //25
    for (int cct = 4000; cct <= 10000; cct += 250) {
      //日光
      Illuminant i = Illuminant.getDaylightByTemperature(cct);
      list.add(i);
    }
    //12
    for (Illuminant i : getFluorescents()) {
      //螢光燈
      list.add(i);
    }
    //68
    int size = list.size();
    return list.toArray(new Illuminant[size]);
  }

  public final static Illuminant[] getFluorescents() {
    Illuminant[] fluorescents = new Illuminant[12];
    fluorescents[0] = F1;
    fluorescents[1] = F2;
    fluorescents[2] = F3;
    fluorescents[3] = F4;
    fluorescents[4] = F5;
    fluorescents[5] = F6;
    fluorescents[6] = F7;
    fluorescents[7] = F8;
    fluorescents[8] = F9;
    fluorescents[9] = F10;
    fluorescents[10] = F11;
    fluorescents[11] = F12;
    return fluorescents;
  }

  private Illuminant() {

  }

  public Illuminant(Spectra spectra) {
    this.spectra = spectra;
  }

  public static void main(String[] args) {

    Plot2D plot = Plot2D.getInstance();
    for (Illuminant i : getFluorescents()) {
      Spectra s = i.getSpectra();
      System.out.println(s.getName());
//      System.out.println(i.toString());
      plot.addSpectra(s.getName(), s);
    }
    plot.setVisible();

  }

  /**
   * getData
   *
   * @return double[][]
   */
  public double[] getData() {
    return spectra.data;
  }

  /**
   * getEnd
   *
   * @return int
   */
  public int getEnd() {
    return spectra.end;
  }

  /**
   * getInterval
   *
   * @return int
   */
  public int getInterval() {
    return spectra.interval;
  }

  private Spectra spectra;

  /**
   * getStart
   *
   * @return int
   */
  public int getStart() {
    return spectra.start;
  }

  public Spectra getSpectra() {
    return spectra;
  }

  private Spectra normalizeSpectra;

  /**
   *
   * @return Illuminant
   * @deprecated
   */
  public Illuminant getNormalizeIlluminant() {
    return new Illuminant(getNormalizeSpectra());
  }

  /**
   *
   * @return Spectra
   * @deprecated
   */
  public Spectra getNormalizeSpectra() {
    if (normalizeSpectra == null) {
      normalizeSpectra = (Spectra) spectra.clone();
      normalizeSpectra.normalizeDataToMax();
    }
    return normalizeSpectra;
  }

  private CIEXYZ normalizeXYZ;

  /**
   * 取得經過Y值正規化為100的XYZ
   * @return CIEXYZ
   */
  public CIEXYZ getNormalizeXYZ() {
    if (normalizeXYZ == null) {
      normalizeXYZ = (CIEXYZ) spectra.getXYZ().clone();
      normalizeXYZ.normalizeY();
    }
    return normalizeXYZ;
  }

  private CIEXYZ getNormalizeXYZ(boolean lock) {
    CIEXYZ XYZ = getNormalizeXYZ();
    if (lock) {
      XYZ = (CIEXYZ) XYZ.clone();
      XYZ.setValuesLock(true);
    }
    return XYZ;
  }

//  private final static String illuminantFilename =
//      "Reference Files/CIE/Illuminant2.cxf";
  private final static String[] illuminantName = new String[] {
      "IlluminantA", "IlluminantB", "IlluminantC",
      "IlluminantD50", "IlluminantD55", "IlluminantD65", "IlluminantD75",
      "s0", "s1", "s2",
      "IlluminantF5", "IlluminantF6", "IlluminantF7", "IlluminantF8",
      "IlluminantF9", "IlluminantF10", "IlluminantF11", "IlluminantF12",
      "IlluminantF1", "IlluminantF2", "IlluminantF3", "IlluminantF4"};
  private final static Illuminant[] illuminantArray = new Illuminant[
      illuminantName.length];

  private final static boolean InitFromCxF = false;
  /**
   * 初始化常用的CIE照明體資料
   */
  static {
    if (InitFromCxF) {
      int size = illuminantName.length;
      InputStream resource = CIE.class.getResourceAsStream("Illuminant2.cxf");
      CXFOperator cxf = new CXFOperator(resource);
      Map<String, Spectrum> illuminantMap = cxf.getSpectrumMap(0);
      Map<String, Conditions> conditionsMap = cxf.getConditionsMap();

      for (int x = 0; x < size; x++) {
        String name = illuminantName[x];
        Spectrum spectrum = illuminantMap.get(name);
        Conditions conditions = conditionsMap.get(spectrum.getConditions());
        Spectra spectra = new Spectra(name, spectrum, conditions);
        if (!name.equals("s0") && !name.equals("s1") && !name.equals("s2")) {
          spectra.normalizeDataToMax();
        }

        illuminantArray[x] = new Illuminant(spectra);
      }
    }
  }

  /**
   * 從XYZ找到最接近的CIE照明體
   * @param XYZ CIEXYZ
   * @return CIEIlluminant
   */
  public final static Illuminant getCIEIlluminant(CIEXYZ XYZ) {
    XYZ.normalizeY();
    double[] XYZValues = XYZ.getValues();
    double[] illuminantValues = new double[3];
    double indicator = Double.MAX_VALUE;
    int minIndicatorIndex = 0;

    for (int x = 0; x < illuminantArray.length; x++) {
      Illuminant illuminant = illuminantArray[x];
      if (illuminant == S0 || illuminant == S1 || illuminant == S2) {
        continue;
      }

      CIEXYZ illuminantXYZ = illuminant.getNormalizeXYZ();
      illuminantXYZ.getValues(illuminantValues);

      double rmsd = Maths.RMSD(illuminantValues, XYZValues);
      if (rmsd < indicator) {
        indicator = rmsd;
        minIndicatorIndex = x;
      }

    }
    return illuminantArray[minIndicatorIndex];
  }

  public final static Illuminant A = illuminantArray[0];
  public final static Illuminant B = illuminantArray[1];
//  public final static Illuminant C = illuminantArray[2];
  public final static Illuminant C = InitFromCxF ? illuminantArray[2] :
      new Illuminant(new Spectra(
          "IlluminantC", Spectra.SpectrumType.AMBIENTLIGHT, 320, 830, 1,
          new double[] {8.058017727639001E-5, 4.966639806607575E-4,
          8.852538275584207E-4, 0.0012189363416599515, 0.0014701853344077358,
          0.0016116035455278003, 0.0016437550362610799, 0.0016797743755036262,
          0.001860918614020951, 0.0023282836422240127, 0.0032232070910556006,
          0.004634327155519742, 0.006440370668815472, 0.008467365028203062,
          0.010542304593070106, 0.012489927477840453, 0.014197421434327156,
          0.01579129734085415, 0.017458501208702657, 0.019384367445608383,
          0.021756647864625306, 0.024699435938759066, 0.02808863819500403,
          0.03173972602739726, 0.035465753424657534, 0.03908138597904915,
          0.04246091861402095, 0.04571313456889605, 0.049008863819500405,
          0.05251732473811443, 0.05640612409347301, 0.060787268331990336,
          0.06553746978243352, 0.07047381144238517, 0.07541498791297341,
          0.08017727639000806, 0.08464947622884772, 0.08901692183722805,
          0.09352135374697824, 0.09841257050765512, 0.10394842868654312,
          0.11028203062046738, 0.11721192586623691, 0.12443190975020146,
          0.13165995165189362, 0.1385979049153908, 0.14505237711522967
          , 0.1512973408541499, 0.15769540692989525, 0.16461724415793713,
          0.1724415793714746, 0.18141015310233685, 0.19122481869460115,
          0.2014826752618856, 0.21174053182917005, 0.22159548751007252,
          0.23074939564867042, 0.23941176470588235, 0.2479290894439968,
          0.2566478646253022, 0.26591458501208703, 0.27598710717163577,
          0.2867687348912168, 0.2980902497985496, 0.3097904915390814,
          0.32167606768734897, 0.33361804995970995, 0.34560032232070914,
          0.3576390008058018, 0.36975020145044324, 0.38195004029008867,
          0.3942546333601934, 0.4066639806607575, 0.4191861402095085,
          0.4318211120064464, 0.4445608380338437, 0.45742143432715554,
          0.4703948428686543, 0.48349717969379535, 0.496720386784851,
          0.5100725221595488, 0.5235616438356165, 0.5371716357775987,
          0.550894439967768, 0.5647219983883964, 0.5786462530217567,
          0.5926510878323933, 0.6067365028203063, 0.6209105560032233,
          0.6351490733279613, 0.6494762288477034, 0.6638678485092667,
          0.6782997582594683, 0.6927316680096697, 0.707123287671233,
          0.7214343271555198, 0.735624496373892
          , 0.7496696212731668, 0.7635132957292506, 0.7771394037066882,
          0.7904915390813859, 0.8035535858178888, 0.8162771958098308,
          0.8286865431103949, 0.8407735697018535, 0.8525382755842063,
          0.8639000805801773, 0.8749395648670427, 0.8855761482675263,
          0.8958098307816278, 0.9057211925866238, 0.9152296535052378,
          0.9243352135374697, 0.9329572925060435, 0.9411764705882353,
          0.9488315874294924, 0.9560032232070911, 0.962610797743755,
          0.9687348912167607, 0.9742143432715553, 0.9790491539081386,
          0.9833199033037873, 0.9869460112812249, 0.9900886381950041,
          0.9926672038678486, 0.9947622884770347, 0.9964544721998388,
          0.9977437550362611, 0.998549556809025, 0.9990330378726834,
          0.9991941982272361, 0.9990330378726834, 0.998549556809025,
          0.9978243352135375, 0.9969379532634972, 0.9959709911361805,
          0.9949234488315875, 0.9939564867042707, 0.9930701047542304,
          0.9924254633360193, 0.991941982272361, 0.9917808219178083,
          0.991941982272361, 0.992344883158743, 0.9929089443996777,
          0.9935535858178888, 0.9943593875906528, 0.9951651893634167,
          0.9959709911361805
          , 0.9967767929089445, 0.9975825946817083, 0.9983078162771959,
          0.9988718775181306, 0.9993553585817889, 0.9996776792908945,
          0.9999194198227237, 1.0, 0.9999194198227237, 0.999597099113618,
          0.9991136180499597, 0.9983883964544723, 0.9974214343271556,
          0.9962127316680097, 0.9946011281224819, 0.992747784045125,
          0.990491539081386, 0.9878323932312651, 0.9847703464947622,
          0.9812248186946011, 0.9771958098307817, 0.9726027397260275,
          0.9674456083803386, 0.9617244157937147, 0.9555197421434327,
          0.9489121676067688, 0.9419822723609993, 0.9347300564061242,
          0.9271555197421435, 0.91941982272361, 0.9114423851732474,
          0.9033037872683319, 0.8950846091861402, 0.886784850926672,
          0.8784850926672039, 0.8702659145850121, 0.8620467365028204,
          0.8539887187751813, 0.8461724415793715, 0.8385979049153908,
          0.8312651087832393, 0.8243352135374697, 0.8178082191780822,
          0.8116841257050766, 0.8060435132957293, 0.8009024979854956,
          0.7962127316680098, 0.792030620467365, 0.788372280419017,
          0.7852618855761483, 0.7827397260273974, 0.7808219178082193
          , 0.7795245769540694, 0.7788154713940371, 0.778662369057212,
          0.7790249798549558, 0.7798549556809026, 0.7811200644641418,
          0.7827880741337632, 0.7847945205479453, 0.7871071716357777,
          0.7896857373086221, 0.7924818694601128, 0.7954713940370669,
          0.7986301369863014, 0.8019178082191781, 0.8053182917002417,
          0.8087832393231266, 0.8123287671232877, 0.8158742949234489,
          0.8193392425463337, 0.8227236099919419, 0.8260273972602741,
          0.8291700241740533, 0.8321514907332797, 0.8349717969379533,
          0.8376309427880742, 0.8401289282836423, 0.8423045930701049,
          0.844399677679291, 0.8461724415793715, 0.8477034649476229,
          0.8489927477840452, 0.8500402900886382, 0.8507655116841257,
          0.8512489927477841, 0.8514907332796132, 0.8514101531023368,
          0.8510878323932314, 0.8505237711522966, 0.8496373892022563,
          0.8485092667203868, 0.8470588235294119, 0.8454472199838841,
          0.8435132957292507, 0.8413376309427881, 0.8389202256244964,
          0.836341659951652, 0.8335213537469782, 0.8306204673650283,
          0.8275584206285255, 0.8243352135374697, 0.8210314262691378,
          0.8176470588235294
          , 0.8141821112006448, 0.8106365834004835, 0.807010475423046,
          0.8033118452860597, 0.7995568090249798, 0.7957534246575343,
          0.7919258662369058, 0.7880741337630943, 0.7842224012892829,
          0.7803706688154713, 0.7765431103948429, 0.7727397260273974,
          0.76897663174859, 0.7652618855761483, 0.7616035455278002,
          0.7580096696212733, 0.7544721998388396, 0.7510072522159549,
          0.7476148267526188, 0.7443110394842869, 0.7411039484286867,
          0.7380177276390008, 0.7350523771152296, 0.7322320709105561,
          0.7295809830781628, 0.7271152296535053, 0.7248428686543111,
          0.7228041901692184, 0.7209991941982272, 0.71941982272361,
          0.7180419016921837, 0.7168412570507655, 0.7157937147461725,
          0.7148912167606769, 0.7141015310233684, 0.7134246575342467,
          0.7128364222401289, 0.7123287671232877, 0.7118855761482675,
          0.7114987912973408, 0.71116035455278, 0.7108783239323127,
          0.7106365834004835, 0.7104351329572925, 0.7102659145850122,
          0.7101208702659146, 0.7100080580177276, 0.7099113618049959,
          0.7098307816277196, 0.7097582594681708, 0.7097018533440774
          , 0.7096454472199839, 0.7095890410958905, 0.709532634971797,
          0.7094601128122482, 0.7093714746172441, 0.7092586623690573,
          0.7091055600322321, 0.7089121676067688, 0.7086946011281225,
          0.7084528605962933, 0.7082111200644642, 0.7079774375503627,
          0.7077679290894441, 0.707590652699436, 0.7074778404512491,
          0.7074375503626109, 0.7074939564867043, 0.7076631748589847,
          0.7079210314262692, 0.7082514101531024, 0.7086220789685738,
          0.7090249798549557, 0.7094278807413377, 0.7098146655922642,
          0.7101692183722805, 0.7104754230459307, 0.7107171635777599,
          0.7108863819500404, 0.7109669621273167, 0.7109750201450443,
          0.7108863819500404, 0.7107171635777599, 0.7104512489927478,
          0.710088638195004, 0.7096212731668009, 0.7090249798549557,
          0.7082997582594682, 0.7074375503626109, 0.7064464141821113,
          0.7053424657534247, 0.7041257050765513, 0.7028203062046737,
          0.7014343271555198, 0.6999758259468172, 0.6984770346494762,
          0.6969460112812248, 0.6954069298952458, 0.6938678485092667,
          0.6923126510878324, 0.6907171635777599, 0.6890733279613215,
          0.6873489121676067, 0.6855278001611603, 0.6835858178887994,
          0.6815149073327961, 0.6792828364222402, 0.6768734891216761,
          0.6742788074133763, 0.6715149073327961, 0.6685979049153908,
          0.6655761482675262, 0.6624496373892023, 0.6592586623690572,
          0.6560193392425464, 0.6527639000805802, 0.6495004029008864,
          0.6462530217566479, 0.6430459307010477, 0.6398710717163578,
          0.6367203867848509, 0.6335858178887994, 0.6304593070104754,
          0.6273327961321515, 0.6242062852538276, 0.6210797743755035,
          0.6179532634971797, 0.6148267526188558, 0.6117082997582595,
          0.6085817888799356, 0.6054633360193393, 0.6023287671232876,
          0.5991941982272361, 0.5960515713134569, 0.5928928283642224,
          0.589734085414988, 0.5865672844480259, 0.5834004834810638,
          0.5802336825141016, 0.5770427074939566, 0.5738356164383561,
          0.5705882352941177, 0.5672844480257857, 0.5639242546333603,
          0.5605318291700242, 0.5571232876712329, 0.5537228041901693,
          0.5503626107977437, 0.5470588235294118, 0.5438114423851732,
          0.5405962933118452, 0.5374133763094279, 0.5342465753424658,
          0.5310878323932313
          , 0.5279613215149074, 0.5248751007252216, 0.5218614020950847,
          0.5189363416599517, 0.516116035455278, 0.513416599516519,
          0.5108299758259468, 0.5083722804190169, 0.5060435132957293,
          0.5038436744560838, 0.5017324738114424, 0.49967767929089446,
          0.49763900080580176, 0.4955680902497986, 0.49344077356970184,
          0.49128928283642226, 0.48915390813859794, 0.487074939564867,
          0.4850926672038679, 0.4832473811442385, 0.4815229653505238,
          0.47992747784045126, 0.4784286865431104, 0.47703464947622887,
          0.4757211925866237, 0.4745044319097502, 0.4733682514101531,
          0.4723368251410153, 0.47139403706688154, 0.4705560032232071,
          0.4698146655922643, 0.46917808219178087, 0.46863013698630135,
          0.468170829975826, 0.4678082191780822, 0.4675342465753425,
          0.4673650282030621, 0.4673086220789686, 0.4673650282030621,
          0.4675423045930701, 0.4678162771958098, 0.4681627719580983,
          0.4685576148267527, 0.4689766317485899, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
          0.0,
          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
          0.0,
          0.0, 0.0, 0.0
          , 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
          0.0,
          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
          0.0,
          0.0, 0.0, 0.0, 0.0, 0.0, 0.0}));
//  public final static Illuminant D50 = illuminantArray[3];
  public final static Illuminant D50 = InitFromCxF ? illuminantArray[3] :
      new Illuminant(new Spectra(
          "IlluminantD50", Spectra.SpectrumType.AMBIENTLIGHT, 300, 830, 1,
          new double[] {1.941747572815534E-4, 0.0021475728155339806,
          0.004104854368932039, 0.006066019417475728, 0.00803106796116505, 0.01,
          0.011972815533980583, 0.013949514563106797, 0.01593009708737864,
          0.017914563106796115, 0.019902912621359223, 0.024027184466019418,
          0.028866019417475727, 0.03441941747572815, 0.0406873786407767,
          0.04766990291262136, 0.05323495145631068, 0.058803883495145634,
          0.06437669902912621, 0.06995339805825242, 0.07553398058252428,
          0.08181747572815533, 0.08833787378640777, 0.09509514563106797,
          0.10208932038834952, 0.10932038834951456, 0.11608932038834952,
          0.1228621359223301, 0.1296388349514563, 0.13641941747572814,
          0.14320388349514562, 0.14777864077669903, 0.15161941747572816,
          0.15472621359223301, 0.1570990291262136, 0.1587378640776699,
          0.16184466019417476, 0.1649514563106796, 0.16805825242718445,
          0.1711650485436893, 0.17427184466019416, 0.17729708737864078,
          0.18029514563106797, 0.18326601941747572, 0.18620970873786408,
          0.189126213592233, 0.19209708737864079, 0.19506796116504854,
          0.1980388349514563
          , 0.20100970873786408, 0.20398058252427187, 0.20688155339805828,
          0.20975922330097088, 0.2126135922330097, 0.21544466019417474,
          0.21825242718446602, 0.22109514563106797, 0.22393398058252428,
          0.22676893203883494, 0.22960000000000003, 0.23242718446601943,
          0.23532038834951455, 0.23823300970873787, 0.2411650485436893,
          0.24411650485436892, 0.2470873786407767, 0.25001941747572815,
          0.2529514563106796, 0.2558834951456311, 0.25881553398058255,
          0.261747572815534, 0.2614757281553398, 0.2601359223300971,
          0.2577281553398058, 0.254252427184466, 0.24970873786407766,
          0.2473126213592233, 0.24492038834951457, 0.24253203883495145,
          0.24014757281553398, 0.2377669902912621, 0.23994563106796118,
          0.2436466019417476, 0.24886990291262137, 0.2556155339805825,
          0.2638834951456311, 0.26910679611650484, 0.27433009708737865,
          0.2795533980582524, 0.2847766990291262, 0.29000000000000004,
          0.30341359223300973, 0.3195572815533981, 0.33843106796116507,
          0.36003495145631065, 0.384368932038835, 0.4032427184466019,
          0.42211650485436897, 0.4409902912621359
          , 0.4598640776699029, 0.47873786407766994, 0.4904815533980582,
          0.4998485436893204, 0.5068388349514563, 0.511452427184466,
          0.5136893203883495, 0.5206796116504855, 0.5276699029126214,
          0.5346601941747573, 0.5416504854368932, 0.5486407766990291,
          0.5534873786407767, 0.5576194174757282, 0.5610368932038835,
          0.5637398058252427, 0.5657281553398058, 0.5691456310679611,
          0.5725631067961164, 0.5759805825242719, 0.5793980582524272,
          0.5828155339805825, 0.5829009708737865, 0.5818757281553398,
          0.5797398058252428, 0.5764932038834951, 0.5721359223300971,
          0.5699883495145631, 0.5678368932038835, 0.5656815533980583,
          0.5635223300970874, 0.5613592233009709, 0.5704, 0.5831728155339806,
          0.5996776699029126, 0.6199145631067962, 0.643883495145631,
          0.660388349514563, 0.6768932038834952, 0.6933980582524272,
          0.7099029126213593, 0.7264077669902912, 0.7402563106796116,
          0.7532194174757281, 0.7652970873786408, 0.7764893203883495,
          0.7867961165048545, 0.79886213592233, 0.8109242718446602,
          0.8229825242718447, 0.8350368932038834, 0.8470873786407767
          , 0.8538679611650486, 0.8588893203883494, 0.8621514563106796,
          0.8636543689320388, 0.8633980582524272, 0.8666601941747574,
          0.8699223300970874, 0.8731844660194175, 0.8764466019417476,
          0.8797087378640777, 0.8814563106796117, 0.8826990291262137,
          0.8834368932038835, 0.8836699029126214, 0.8833980582524271,
          0.8841359223300971, 0.8848737864077669, 0.8856116504854369,
          0.8863495145631067, 0.8870873786407767, 0.8895611650485437,
          0.8926135922330097, 0.8962446601941747, 0.9004543689320388,
          0.9052427184466019, 0.9088737864077671, 0.912504854368932,
          0.916135922330097, 0.9197669902912622, 0.9233980582524272,
          0.923021359223301, 0.9213087378640777, 0.9182601941747572,
          0.9138757281553398, 0.9081553398058253, 0.905095145631068,
          0.9020310679611651, 0.8989631067961165, 0.8958912621359223,
          0.8928155339805824, 0.8937786407766991, 0.896085436893204,
          0.899735922330097, 0.90473, 0.9110679611650486, 0.9147184466019417,
          0.918368932038835, 0.9220193203883496, 0.9256699029126213,
          0.9293203883495146, 0.9313048543689321, 0.9327339805825243
          , 0.9336077669902914, 0.933926213592233, 0.9336893203883495,
          0.9345514563106796, 0.9354097087378641, 0.9362640776699028,
          0.9371145631067962, 0.9379611650485437, 0.9386058252427184,
          0.939180582524272, 0.9396855339805825, 0.9401204854368932,
          0.940485436893204, 0.9409902912621358, 0.941495145631068, 0.942,
          0.942504854368932, 0.943009708737864, 0.9461008737864078,
          0.9500543689320388, 0.9548699029126214, 0.960547572815534,
          0.9670873786407767, 0.9719145631067961, 0.9767456310679611,
          0.9815805825242718, 0.9864194174757283, 0.99126213592233,
          0.9924155339805826, 0.9923417475728156, 0.9910407766990291,
          0.9885126213592234, 0.9847572815533981, 0.9834446601941748,
          0.9821281553398058, 0.9808077669902913, 0.979483495145631,
          0.9781553398058253, 0.9785475728155341, 0.9795106796116505,
          0.9810446601941748, 0.9831495145631067, 0.9858252427184466,
          0.987347572815534, 0.9888660194174758, 0.9903805825242719,
          0.9918912621359224, 0.9933980582524271, 0.992652427184466,
          0.9911533980582525, 0.9889009708737865, 0.985895145631068
          , 0.982135922330097, 0.979883495145631, 0.9776310679611651,
          0.975378640776699, 0.9731262135922331, 0.970873786407767,
          0.9686563106796117, 0.9664504854368932, 0.9642563106796116,
          0.9620738834951457, 0.9599029126213593, 0.9577087378640777,
          0.9555145631067962, 0.9533203883495145, 0.9511262135922329,
          0.9489320388349514, 0.9487417475728155, 0.9492194174757281,
          0.9503650485436894, 0.952178640776699, 0.9546601941747572,
          0.9554563106796117, 0.956135922330097, 0.9566990291262136,
          0.9571457281553398, 0.9574757281553399, 0.9548932038834952,
          0.9512621359223301, 0.9465825242718447, 0.9408543689320389,
          0.9340776699029125, 0.9290485436893203, 0.9239029126213593,
          0.9186407766990292, 0.9132621359223301, 0.9077669902912622,
          0.9080970873786408, 0.9102912621359224, 0.9143495145631068,
          0.9202717475728155, 0.9280582524271845, 0.9321280582524272,
          0.9362018446601942, 0.9402796116504855, 0.9443611650485436,
          0.9484466019417476, 0.9509980582524271, 0.9530407766990292,
          0.954574854368932, 0.9556, 0.9561165048543689, 0.9576504854368932,
          0.9591845631067961, 0.9607184466019417, 0.962252427184466,
          0.9637864077669902, 0.9642718446601941, 0.9644077669902913,
          0.9641941747572815, 0.963631067961165, 0.9627184466019417,
          0.9624932038834951, 0.962264077669903, 0.9620310679611651,
          0.9617941747572816, 0.9615533980582525, 0.959526213592233,
          0.9569009708737864, 0.9536776699029127, 0.9498563106796116,
          0.9454368932038835, 0.9422135922330097, 0.9389902912621358,
          0.9357669902912621, 0.9325436893203884, 0.9293203883495146,
          0.9298601941747573, 0.9316543689320389, 0.9347029126213592,
          0.9390058252427185, 0.9445631067961165, 0.9476116504854369,
          0.9506601941747573, 0.9537087378640776, 0.9567572815533981,
          0.9598058252427184, 0.9591611650485437, 0.9572854368932038,
          0.954178640776699, 0.9498407766990292, 0.9442718446601942,
          0.9411766990291262, 0.9380854368932039, 0.9349980582524272,
          0.9319145631067961, 0.9288349514563107, 0.9290679611650485,
          0.9304077669902912, 0.9328543689320389, 0.9364077669902913,
          0.9410679611650486, 0.9435145631067962, 0.9459611650485437,
          0.9484077669902913
          , 0.9508543689320389, 0.9533009708737864, 0.9570873786407766,
          0.9613203883495146, 0.9660000000000001, 0.971126213592233,
          0.9766990291262135, 0.9813669902912621, 0.986031067961165,
          0.9906912621359224, 0.9953475728155339, 1.0, 0.9996155339805826,
          0.9975495145631068, 0.9938019417475727, 0.9883728155339806,
          0.98126213592233, 0.9775029126213592, 0.9737398058252427,
          0.9699728155339806, 0.9662019417475728, 0.9624271844660194,
          0.9540815533980582, 0.9442097087378641, 0.9328116504854369,
          0.9198873786407767, 0.9054368932038835, 0.8940271844660195,
          0.8826135922330097, 0.8711961165048543, 0.8597747572815534,
          0.8483495145631067, 0.8462407766990292, 0.8472349514563106,
          0.8513319417475729, 0.8585319417475729, 0.8688349514563106,
          0.8729319417475728, 0.8770291262135923, 0.881126213592233,
          0.8852233009708738, 0.8893203883495145, 0.8917165048543689,
          0.8935456310679611, 0.8948077669902913, 0.8955029126213593,
          0.8956310679611651, 0.8968815533980582, 0.8981281553398058,
          0.8993708737864078, 0.9006097087378641, 0.9018446601941748
          , 0.8929980582524273, 0.8807883495145631, 0.8652155339805825,
          0.8462796116504854, 0.8239805825242719, 0.8084077669902913,
          0.7928349514563108, 0.7772621359223302, 0.7616893203883495,
          0.7461165048543689, 0.7455145631067961, 0.7499029126213592,
          0.7592815533980583, 0.7736504854368933, 0.7930097087378641,
          0.8023883495145631, 0.8117669902912621, 0.8211456310679612,
          0.8305242718446602, 0.8399029126213593, 0.8471961165048544,
          0.8537941747572815, 0.8596971844660194, 0.8649049514563107,
          0.8694174757281553, 0.8753087378640777, 0.881196213592233,
          0.8870796116504855, 0.8929592233009709, 0.8988349514563106,
          0.8928233009708738, 0.8828466019417476, 0.8689048543689321,
          0.8509980582524271, 0.829126213592233, 0.8151961165048544,
          0.8012699029126213, 0.787347572815534, 0.7734291262135923,
          0.7595145631067961, 0.7419805825242719, 0.7232427184466019,
          0.7033009708737864, 0.6821553398058252, 0.6598058252427184,
          0.6398640776699029, 0.6199223300970873, 0.5999805825242719,
          0.5800388349514564, 0.5600970873786407, 0.5668233009708739,
          0.5824388349514563, 0.6069436893203883, 0.6403378640776699,
          0.682621359223301, 0.7071144660194175, 0.7316037864077669,
          0.7560893203883495, 0.7805708737864077, 0.8050485436893204,
          0.8121398058252428, 0.8134330097087379, 0.8089281553398058,
          0.7986252427184466, 0.7825242718446601, 0.7780077669902913,
          0.7734873786407768, 0.7689631067961165, 0.764434854368932,
          0.7599029126213592, 0.7588388349514563, 0.7589281553398058,
          0.7601708737864078, 0.7625669902912621, 0.7661165048543689,
          0.7673592233009708, 0.7686020388349515, 0.7698447572815534,
          0.7710873786407767, 0.7723300970873787, 0.7692504854368932,
          0.7647300970873787, 0.7587690291262136, 0.7513669902912621,
          0.7425242718446602, 0.7365514563106796, 0.7305748543689321,
          0.7245941747572816, 0.7186097087378641, 0.712621359223301,
          0.7047067961165049, 0.696147572815534, 0.6869436893203884,
          0.6770952427184466, 0.6666019417475728, 0.6573981553398058,
          0.6481941747572815, 0.6389902912621359, 0.6297864077669902,
          0.6205825242718447, 0.6208970873786408, 0.6243844660194174,
          0.6310446601941748
          , 0.6408776699029126, 0.653883495145631, 0.6605436893203883,
          0.6672038834951456, 0.673864077669903, 0.6805242718446601,
          0.6871844660194175, 0.6919805825242719, 0.6961553398058252,
          0.6997087378640776, 0.7026407766990291, 0.7049514563106796,
          0.7085048543689321, 0.7120582524271845, 0.7156116504854368,
          0.7191651456310679, 0.7227184466019417}));

  public final static Illuminant D55 = illuminantArray[4];
//  public final static Illuminant D65 = illuminantArray[5];
  public final static Illuminant D65 = InitFromCxF ? illuminantArray[5] :
      new Illuminant(new Spectra(
          "IlluminantD65", Spectra.SpectrumType.AMBIENTLIGHT, 300, 830, 1,
          new double[] {2.894441992326758E-4, 0.0030569042202831633,
          0.00582436424133365, 0.008591824262384137, 0.011359284283434625,
          0.01412674430448511, 0.016894204325535598, 0.01966166434658609,
          0.022429124367636576, 0.02519658438868706, 0.02796404440973755,
          0.04234415848979731, 0.056724272569857064, 0.07110438664991682,
          0.08548450072997657, 0.09986419040505212, 0.1142447288900961,
          0.12862441856517162, 0.1430049570502156, 0.15738464672529112,
          0.17176518521033513, 0.18603962244932604, 0.2003149084982854,
          0.21458934573727634, 0.2288646317862357, 0.24313906902522664,
          0.257414355074186, 0.27168879231317694, 0.2859640783621363,
          0.3002385156011272, 0.3145138016500866, 0.3169711065086749,
          0.3194292601772315, 0.3218865650358198, 0.324343869894408,
          0.3268011747529963, 0.329259328421553, 0.3317166332801412,
          0.33417393813872953, 0.3366320918072862, 0.33908939666587445,
          0.3433020405391641, 0.34751468441245376, 0.3517273282857434,
          0.355939972159033, 0.36015176722235426, 0.3643644110956439,
          0.36857705496893356, 0.37278969884222324
          , 0.37700234271551286, 0.38121498658880254, 0.38268088140427126,
          0.3841459274097715, 0.3856118222252402, 0.3870768682307405,
          0.3885427630462092, 0.39000865786167793, 0.3914737038671782,
          0.39293959868264694, 0.39440464468814723, 0.39587053950361595,
          0.40049740264149664, 0.40512426577937727, 0.4097502801072896,
          0.41437714324517033, 0.41900400638305096, 0.42363086952093165,
          0.42825773265881234, 0.4328837469867246, 0.4375106101246053,
          0.44213747326248604, 0.4403430889892371, 0.43854955352595665,
          0.4367551692527077, 0.4349616337894272, 0.4331672495161783,
          0.43137286524292945, 0.42957932977964897, 0.42778494550640006,
          0.4259914100431196, 0.4241970257698706, 0.42816351475231723,
          0.4321291549247954, 0.43609564390724204, 0.44006213288968865,
          0.44402777306216684, 0.44799426204461346, 0.45196075102706007,
          0.4559272400095067, 0.4598928801819849, 0.4638593691644315,
          0.4877168709469324, 0.511573523919465, 0.5354310257019659,
          0.5592885274844668, 0.5831451804569993, 0.6070026822395003,
          0.6308601840220012, 0.6547176858045021
          , 0.6785743387770345, 0.7024318405595356, 0.7098428003938478,
          0.7172537602281601, 0.7246647200624724, 0.7320756798967847,
          0.7394866397310971, 0.7468984483753778, 0.75430940820969,
          0.7617203680440023, 0.7691313278783146, 0.7765422877126269,
          0.7781940719111805, 0.7798458561097342, 0.7814967914983193,
          0.783148575696873, 0.7848003598954266, 0.7864521440939802,
          0.788103928292534, 0.789754863681119, 0.7914066478796727,
          0.7930584320782263, 0.7873289647913625, 0.7816003463144672,
          0.7758708790276032, 0.7701422605507079, 0.7644127932638441,
          0.7586841747869487, 0.7529547075000849, 0.7472260890231895,
          0.7414966217363257, 0.7357680032594303, 0.7512019149152889,
          0.7666349777611788, 0.7820688894170373, 0.7975028010728958,
          0.8129358639187859, 0.8283697755746443, 0.8438036872305029,
          0.8592333548365192, 0.8746732081621567, 0.8901045733881099,
          0.9004091264047804, 0.9107221675211353, 0.921026720537806,
          0.9313312735544766, 0.9416358265711473, 0.9519488676875021,
          0.9622534207041727, 0.9725579737208433, 0.9828710148371982,
          0.9931755678538688
          , 0.9938546158286082, 0.994542151903032, 0.9952211998777714,
          0.995908735952195, 0.9965877839269345, 0.9972668319016739,
          0.9979543679760975, 0.9986334159508369, 0.9993209520252606, 1.0,
          0.9974960105931484, 0.9949920211862968, 0.9924880317794453,
          0.9899840423725936, 0.9874715648660578, 0.9849675754592062,
          0.9824635860523546, 0.9799595966455029, 0.9774556072386514,
          0.9749516178317998, 0.9758513563983295, 0.9767510949648592,
          0.9776593216310733, 0.978559060197603, 0.9794587987641327,
          0.9803585373306625, 0.9812582758971922, 0.9821665025634061,
          0.9830662411299358, 0.9839659796964656, 0.9779309408209691,
          0.9718959019454725, 0.9658523749702916, 0.9598173360947951,
          0.9537822972192986, 0.947747258343802, 0.9417122194683054,
          0.9356686924931247, 0.9296336536176282, 0.9235986147421316,
          0.9240569721250806, 0.9245238176077141, 0.9249821749906632,
          0.9254405323736122, 0.9258988897565613, 0.9263657352391946,
          0.9268240926221438, 0.9272824500050929, 0.9277492954877262,
          0.9282076528706753, 0.9268919974196177, 0.9255763419685601
          , 0.9242521984178182, 0.9229365429667606, 0.921620887515703,
          0.9203052320646454, 0.9189895766135878, 0.9176654330628459,
          0.9163497776117883, 0.9150341221607308, 0.9124792041557737,
          0.9099242861508166, 0.9073608800461752, 0.9048059620412182,
          0.9022510440362612, 0.8996961260313042, 0.8971412080263471,
          0.8945778019217058, 0.8920228839167487, 0.8894679659117918,
          0.8919295148202221, 0.8943910637286525, 0.8968526126370828,
          0.8993141615455132, 0.9017672223542594, 0.9042287712626897,
          0.9066903201711202, 0.9091518690795505, 0.9116134179879809,
          0.9140749668964112, 0.9112908701999797, 0.9084982854038638,
          0.9057141887074321, 0.9029216039113164, 0.9001375072148847,
          0.8973534105184531, 0.8945608257223373, 0.8917767290259057,
          0.8889841442297899, 0.8862000475333582, 0.8858944759447255,
          0.8855889043560927, 0.88528333276746, 0.8849777611788273,
          0.8846721895901946, 0.884375106101246, 0.8840695345126133,
          0.8837639629239805, 0.8834583913353478, 0.8831528197467152,
          0.8797151393745969, 0.8762859471021628, 0.8728482667300445
          , 0.8694190744576105, 0.8659813940854921, 0.8625437137133738,
          0.8591145214409398, 0.8556768410688215, 0.8522476487963875,
          0.8488099684242691, 0.8456982310800257, 0.8425864937357824,
          0.8394756052015075, 0.8363638678572641, 0.8332521305130208,
          0.8301403931687774, 0.827028655824534, 0.8239177672902591,
          0.8208060299460157, 0.8176942926017723, 0.8172308423590127,
          0.8167673921162529, 0.8163030930635249, 0.8158396428207654,
          0.8153761925780056, 0.814912742335246, 0.8144492920924863,
          0.8139849930397582, 0.8135215427969986, 0.813058092554239,
          0.8070298441584898, 0.8010007469527722, 0.7949724985570231,
          0.7889434013513055, 0.7829151529555564, 0.7768869045598071,
          0.7708578073540896, 0.7648295589583404, 0.7588004617526228,
          0.7527722133568736, 0.7538934913251621, 0.7550139204834823,
          0.7561351984517707, 0.7572556276100907, 0.7583769055783791,
          0.7594981835466675, 0.7606186127049877, 0.7617398906732761,
          0.7628603198315961, 0.7639815977998846, 0.763636132142736,
          0.7632906664855873, 0.7629452008284385, 0.7625997351712899,
          0.7622534207041728, 0.761907955047024, 0.7615624893898754,
          0.7612170237327267, 0.760871558075578, 0.7605260924184294,
          0.7589133534784233, 0.7572997657284487, 0.7556870267884426,
          0.754073439038468, 0.752460700098462, 0.7508479611584559,
          0.7492343734084813, 0.7476216344684752, 0.7460080467185006,
          0.7443953077784946, 0.7406520558177435, 0.7369088038569925,
          0.7331655518962414, 0.7294222999354905, 0.725678199164771,
          0.72193494720402, 0.7181916952432689, 0.7144484432825179,
          0.7107051913217669, 0.7069619393610159, 0.7073108002580383,
          0.7076588123450922, 0.7080076732421146, 0.7083556853291685,
          0.7087045462261908, 0.7090534071232132, 0.7094014192102671,
          0.7097502801072896, 0.7100982921943436, 0.710447153091366,
          0.7073303228873119, 0.7042126438732896, 0.7010958136692357,
          0.6979781346552134, 0.6948613044511595, 0.6917444742471056,
          0.6886267952330832, 0.6855099650290294, 0.682392286015007,
          0.679275455810953, 0.6794350320850168, 0.6795946083590806,
          0.679753335823176, 0.6799129120972397, 0.6800724883713034,
          0.6802320646453672
          , 0.6803916409194309, 0.6805503683835263, 0.6807099446575902,
          0.6808695209316539, 0.6826206158965131, 0.6843717108613724,
          0.6861236546362001, 0.6878747496010593, 0.6896258445659186,
          0.6913769395307778, 0.6931280344956371, 0.6948799782704649,
          0.6966310732353241, 0.6983821682001834, 0.6949920211862968,
          0.6916027229823788, 0.6882125759684922, 0.6848232777645741,
          0.6814331307506876, 0.678042983736801, 0.6746536855328829,
          0.6712635385189963, 0.6678742403150782, 0.6644840933011917,
          0.6572157335415747, 0.6499473737819578, 0.6426790140223407,
          0.6354106542627236, 0.6281422945031067, 0.620874783553458,
          0.613606423793841, 0.606338064034224, 0.599069704274607,
          0.59180134451499,
          0.593403897735375, 0.59500645095576, 0.5966081553661766,
          0.5982107085865617, 0.5998132618069466, 0.6014158150273317,
          0.6030183682477167, 0.6046200726581333, 0.6062226258785183,
          0.6078251790989033, 0.6101509184123859, 0.6124766577258683,
          0.6148023970393508, 0.6171281363528334, 0.6194530268563474,
          0.62177876616983, 0.6241045054833124, 0.6264302447967949
          , 0.6287559841102774, 0.6310817234237599, 0.6202636403761926,
          0.6094455573286253, 0.5986274742810579, 0.5878093912334907,
          0.5769913081859234, 0.566173225138356, 0.5553551420907887,
          0.5445370590432215, 0.5337189759956541, 0.5229008929480868,
          0.5299307371065766, 0.536959732455098, 0.5439895766135877,
          0.5510185719621091, 0.558048416120599, 0.5650782602790887,
          0.5721072556276101, 0.5791370997860998, 0.5861660951346213,
          0.5931959392931111, 0.5976105999388857, 0.6020261093946288,
          0.6064407700404033, 0.6108562794961464, 0.6152709401419211,
          0.6196856007876956, 0.6241011102434387, 0.6285157708892134,
          0.6329312803449564, 0.637345940990731, 0.6275897192136625,
          0.6178326486266255, 0.608076426849557, 0.5983202050724884,
          0.5885631344854514, 0.5788069127083828, 0.5690506909313143,
          0.5592944691542457, 0.5495373985672087, 0.5397811767901403,
          0.5252028655824534, 0.510625403184735, 0.4960470919770482,
          0.4814696295793298, 0.466891318371643, 0.45231385597392454,
          0.43773554476623777, 0.4231580823685193, 0.4085797711608325,
          0.3940023087631141, 0.41130699758937966, 0.4286116864156453,
          0.4459172240518793, 0.46322191287814485, 0.48052660170441047,
          0.497831290530676, 0.5151359793569416, 0.5324415169931755,
          0.5497462058194411, 0.5670508946457068, 0.5641454181237905,
          0.5612407904118426, 0.5583353138899263, 0.5554306861779785,
          0.5525252096560622, 0.5496197331341459, 0.546715105422198,
          0.5438096289002818, 0.540905001188334, 0.5379995246664178,
          0.5387812786473364, 0.5395630326282552, 0.5403456354191424,
          0.5411273894000611, 0.54190914338098, 0.5426908973618986,
          0.5434726513428174, 0.5442552541337046, 0.5450370081146233,
          0.545818762095542, 0.5417003361287476, 0.5375819101619529,
          0.5334634841951584, 0.5293450582283639, 0.5252257834516009,
          0.5211073574848063, 0.5169889315180117, 0.5128705055512172,
          0.5087520795844227, 0.5046336536176281, 0.498273520524225,
          0.49191338743082197, 0.48555325433741897, 0.4791931212440159,
          0.4728329881506128, 0.46647370386717824, 0.4601135707737752,
          0.45375343768037213, 0.4473933045869691, 0.4410331714935661,
          0.44568634774046784
          , 0.45033867517740134, 0.4549918514243031, 0.4596441788612366,
          0.4642973551081384, 0.4689505313550402, 0.47360285879197367,
          0.4782560350388755, 0.4829083624758089, 0.4875615387227108,
          0.4899993209520253, 0.49243710318133976, 0.4948748854106543,
          0.49731266763996873, 0.4997496010593149, 0.5021873832886293,
          0.5046251655179438, 0.5070629477472584, 0.5095007299765729,
          0.5119385122058874}));
  public final static Illuminant D75 = illuminantArray[6];

  public final static Illuminant S0 = InitFromCxF ? illuminantArray[7] :
      new Illuminant(new Spectra(
          "s0", Spectra.SpectrumType.AMBIENTLIGHT, 300, 830, 5,
          new double[] {0.04, 3.02, 6.0, 17.8, 29.6, 42.45, 55.3, 56.3, 57.3,
          59.55, 61.8, 61.65, 61.5, 65.15, 68.8, 66.1, 63.4, 64.6, 65.8, 80.3,
          94.8, 99.8, 104.8, 105.35, 105.9, 101.35, 96.8, 105.35, 113.9, 119.75,
          125.6, 125.55, 125.5, 123.4, 121.3, 121.3, 121.3, 117.4, 113.5, 113.3,
          113.1, 111.95, 110.8, 108.65, 106.5, 107.65, 108.8, 107.05, 105.3,
          104.85, 104.4, 102.2, 100.0, 98.0, 96.0, 95.55, 95.1, 92.1, 89.1,
          89.8, 90.5, 90.4, 90.3, 89.35, 88.4, 86.2, 84.0, 84.55, 85.1, 83.5,
          81.9, 82.25, 82.6, 83.75, 84.9, 83.1, 81.3, 76.6, 71.9, 73.1, 74.3,
          75.35, 76.4, 69.85, 63.3, 67.5, 71.7, 74.35, 77.0, 71.1, 65.2, 56.45,
          47.7, 58.15, 68.6, 66.8, 65.0, 65.5, 66.0, 63.5, 61.0, 57.15, 53.3,
          56.1, 58.9, 60.4, 61.9}));
  public final static Illuminant S1 = InitFromCxF ? illuminantArray[8] :
      new Illuminant(new Spectra(
          "s1", Spectra.SpectrumType.AMBIENTLIGHT, 300, 830, 5,
          new double[] {0.02, 2.26, 4.5, 13.45, 22.4, 32.2, 42.0, 41.3, 40.6,
          41.1, 41.6, 39.8, 38.0, 40.2, 42.4, 40.45, 38.5, 36.75, 35.0, 39.2,
          43.4, 44.85, 46.3, 45.1, 43.9, 40.5, 37.1, 36.9, 36.7, 36.3, 35.9,
          34.25, 32.6, 30.25, 27.9, 26.1, 24.3, 22.2, 20.1, 18.15, 16.2, 14.7,
          13.2, 10.9, 8.6, 7.35, 6.1, 5.15, 4.2, 3.05, 1.9, 0.95, 0.0, -0.8,
          -1.6, -2.55, -3.5, -3.5, -3.5, -4.65, -5.8, -6.5, -7.2, -7.9, -8.6,
          -9.05, -9.5, -10.2, -10.9, -10.8, -10.7, -11.35, -12.0, -13.0, -14.0,
          -13.8, -13.6, -12.8, -12.0, -12.65, -13.3, -13.1, -12.9, -11.75,
          -10.6, -11.1, -11.6, -11.9, -12.2, -11.2, -10.2, -9.0, -7.8, -9.5,
          -11.2, -10.8, -10.4, -10.5, -10.6, -10.15, -9.7, -9.0, -8.3, -8.8,
          -9.3, -9.55, -9.8}));
  public final static Illuminant S2 = InitFromCxF ? illuminantArray[9] :
      new Illuminant(new Spectra(
          "s2", Spectra.SpectrumType.AMBIENTLIGHT, 300, 830, 5,
          new double[] {0.0, 1.0, 2.0, 3.0, 4.0, 6.25, 8.5, 8.15, 7.8, 7.25,
          6.7, 6.0, 5.3, 5.7, 6.1, 4.55, 3.0, 2.1, 1.2, 0.05, -1.1, -0.8, -0.5,
          -0.6, -0.7, -0.95, -1.2, -1.9, -2.6, -2.75, -2.9, -2.85, -2.8, -2.7,
          -2.6, -2.6, -2.6, -2.2, -1.8, -1.65, -1.5, -1.4, -1.3, -1.25, -1.2,
          -1.1, -1.0, -0.75, -0.5, -0.4, -0.3, -0.15, 0.0, 0.1, 0.2, 0.35, 0.5,
          1.3, 2.1, 2.65, 3.2, 3.65, 4.1, 4.4, 4.7, 4.9, 5.1, 5.9, 6.7, 7.0,
          7.3, 7.95, 8.6, 9.2, 9.8, 10.0, 10.2, 9.25, 8.3, 8.95, 9.6, 9.05, 8.5,
          7.75, 7.0, 7.3, 7.6, 7.8, 8.0, 7.35, 6.7, 5.95, 5.2, 6.3, 7.4, 7.1,
          6.8, 6.9, 7.0, 6.7, 6.4, 5.95, 5.5, 5.8, 6.1, 6.3, 6.5}));
  public final static Illuminant F5 = illuminantArray[10];
  public final static Illuminant F6 = illuminantArray[11];
  public final static Illuminant F7 = illuminantArray[12];
  public final static Illuminant F8 = illuminantArray[13];
  public final static Illuminant F9 = illuminantArray[14];
  public final static Illuminant F10 = illuminantArray[15];
  public final static Illuminant F11 = illuminantArray[16];
  public final static Illuminant F12 = illuminantArray[17];
  public final static Illuminant F1 = illuminantArray[18];
  public final static Illuminant F2 = illuminantArray[19];
  public final static Illuminant F3 = illuminantArray[20];
  public final static Illuminant F4 = illuminantArray[21];

  public final static CIEXYZ D50WhitePoint = D50.getNormalizeXYZ(true);
  public final static CIEXYZ D65WhitePoint = D65.getNormalizeXYZ(true);
  public final static Illuminant D93 = Illuminant.getDaylightByTemperature(9300);
  public final static CIEXYZ D93WhitePoint = D93.getNormalizeXYZ(true);

  public final static Illuminant E = new Illuminant(new Spectra("IlluminantE",
      Spectra.SpectrumType.EMISSION, 380, 780,
      1, DoubleArray.fill(1, 401, 1)[0]));

  /**
   * 可經由色溫的指定計算出所有的CIE D光源光譜
   * @param tempK int
   * @return CIEIlluminant
   */
  public static Illuminant getDaylightByTemperature(int tempK) {
    CIExyY xyY = CIExyY.fromCCT2DIlluminant(tempK);
    double xd = xyY.x;
    double yd = xyY.y;

    double M = (0.0241 + 0.2562 * xd - 0.7341 * yd);
    double M1 = ( -1.3515 - 1.7703 * xd + 5.9114 * yd) / M;
    double M2 = (0.0300 - 31.4424 * xd + 30.0717 * yd) / M;
//    System.out.println(M + " " + M1 + " " + M2);

    int start = S0.getStart();
    int end = S0.getEnd();
    int interval = S0.getInterval();
    int size = S0.getData().length;
    double[] data = new double[size];

    for (int i = 0; i < size; i++) {
      data[i] = S0.getData()[i] + M1 * S1.getData()[i] +
          M2 * S2.getData()[i];
    }
    Spectra spectra = new Spectra("D-" + tempK, Spectra.SpectrumType.EMISSION,
                                  start,
                                  end, interval,
                                  data);
    spectra.normalizeDataToMax();
    return new Illuminant(spectra);
  }

  public final static CIEXYZ getD50WhitePoint() {
    return (CIEXYZ) D50.getNormalizeXYZ().clone();
  }

  public final static CIEXYZ getD65WhitePoint() {
    return (CIEXYZ) D65.getNormalizeXYZ().clone();
  }

  public final static CIEXYZ getD93WhitePoint() {
    return (CIEXYZ) D93.getNormalizeXYZ().clone();
  }

  /**
   * Returns a string representation of the object.
   *
   * @return a string representation of the object.
   */
  public String toString() {
    return this.getSpectra().getName();
  }

}
